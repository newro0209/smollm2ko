# AGENTS.md

## 🎯 Purpose

이 문서는 **연구·실험·프로토타이핑 목적의 코드**를 작성할 때 적용되는 작업 규칙을 정의합니다.
본 AGENTS.md는 빠른 가설 검증과 반복 실험을 우선하며, 제품 코드에 적용되는 테스트·배포 중심 규칙은 포함하지 않습니다.

이 파일은 사람이 읽기 위한 문서이면서 동시에, 자동화된 코딩 에이전트가 **행동 규칙으로 직접 해석**하는 기준 문서입니다.

아래 규칙을 하나라도 위반한 변경은 PR 리뷰에서 반려될 수 있습니다.

### 📌 작업 프로세스 (권장 순서)

1. 가상환경을 활성화하고 실험 환경을 준비합니다.
2. 검증하려는 가설이나 실험 목적을 간단히 정의합니다.
3. 빠른 반복을 우선하되, Pyright 기준 타입 에러가 발생하지 않도록 코드를 작성합니다.
4. 복잡하거나 오해 소지가 있는 로직에 한해 주석으로 보완 설명합니다.
5. PEP 규칙 위반이나 명백한 코드 냄새가 없는지 점검합니다.
6. 실험 단계별로 의미 있는 단위로 커밋합니다.

---

## 🧩 Environment Requirements

* 작업 시작 전 항상 가상환경을 활성화합니다.

```bash
source .venv/bin/activate
```

* IDE 종류와 무관하게 **Pyright 기반 정적 분석**을 사용합니다.
* 타입 체크 설정은 반드시 `pyproject.toml`에서 관리합니다.
* `pyrightconfig.json` 사용을 금지합니다.

```toml
[tool.pyright]
typeCheckingMode = "basic"
```

* 모든 변경은 **Pyright 기준 Type Error 0 상태**를 유지해야 합니다.

---

## 📝 Language & Documentation

* 모든 **주석과 문서**는 한국어로 작성합니다.
* 주석은 코드 이해에 **실질적인 도움이 되는 경우에 적절히 작성**합니다.
* 로직이 복잡하거나, 오해의 소지가 있거나, **외부 논문·문서·스펙을 참고한 경우**에는 주석을 추가합니다.
* 단순하고 자명한 코드에 불필요한 주석을 과도하게 추가하지 않습니다.
* 함수 이름만으로 의도가 완전히 전달되지 않는 경우에는 로직 설명 주석을 보완합니다.
* 가독성 향상을 목적으로 하는 경우, **주석 내 이모지 사용을 허용**합니다. (과도한 사용은 지양)

---

## 🧠 Programming Style

* 로직이 짧고 간결하며 상태 관리가 필요 없는 경우에는 **함수형 프로그래밍 패러다임**을 사용합니다.
* 실험 흐름이 복잡하거나, 명확한 **상태 관리·단계 구분이 필요한 경우에는 객체지향 프로그래밍 패러다임(OOP)**을 사용합니다.
* 전역 상태 사용은 지양하되, 실험 편의상 필요한 경우에는 **명시적으로 제한된 범위**에서 허용합니다.
* 암묵적 동작을 지양하고, **의도를 드러내는 명시적 로직**을 사용합니다.
* **코드는 항상 불필요하게 길어지지 않도록 작성**합니다.
* 불필요한 추상화, 과도한 계층 분리는 지양합니다.

---

## 🧬 Type Hint & PEP Compliance Rules

* 본 저장소의 모든 코드는 **PEP 규칙을 준수**하여 기본적인 일관성을 유지해야 합니다.
* 연구 코드 특성을 고려하되, 아래 PEP은 필수 기준으로 합니다.

### 필수 준수 PEP

* **PEP 8**: 코드 스타일 및 가독성
* **PEP 257**: Docstring 작성 규칙
* **PEP 484**: 타입 힌트(Type Hints)
* **PEP 526**: 변수 어노테이션(Variable Annotations)
* **PEP 544**: 프로토콜 기반 서브타이핑(Structural Subtyping / Protocol)

### 타입 힌트 세부 규칙

* 타입 힌트는 내장 타입을 우선 사용합니다.
* 실험 중 불완전한 타입은 `typing.Any` 사용을 허용하되, 남용하지 않습니다.
* 구조적 계약이 중요한 경우 `typing.Protocol` 사용을 권장합니다.

---

## 🧾 Commit Rules

* 커밋 메시지는 **Gitmoji**를 사용합니다.
* 타입(이모지)을 제외한 제목과 본문은 한국어로 작성합니다.
* 실험 단계별 의미 있는 변경 단위로 커밋합니다.

---

## 🚨 Exception Handling

* 실험을 위한 임시 코드 또는 우회 로직은 **주석으로 명확히 표시**해야 합니다.
* 실험 종료 후 제거 예정인 코드는 TODO로 명시합니다.

```python
# TODO: 실험 종료 후 정식 구현으로 교체
```

---

## 🤖 허깅페이스 데이터셋 적용 절차 (에이전트 전용)

* 새로운 데이터셋을 적용할 때는 반드시 `scripts/inspect_hf_datasets.py`를 먼저 실행해 구조를 확인합니다.
* `inspect_hf_datasets.py`의 출력 결과(스키마/샘플)를 근거로 `experiments/` 내부에 변환 함수를 작성합니다.
* 변환 함수는 통일 포맷으로 변환되도록 구현하고, 그 변환이 적용된 데이터셋으로 연구를 진행합니다.
* 변환 함수가 추가되면 해당 데이터셋을 사용하는 실험 코드에서 일관되게 적용합니다.

---

이 문서는 **빠른 실험과 가설 검증을 방해하지 않으면서도, 코드 일관성을 유지하기 위한 최소 기준**을 제공합니다.
